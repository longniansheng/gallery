{"version":3,"sources":["utils.ts","useImagesHook.ts","ImageSection.tsx","NavSection.tsx","App.tsx","index.tsx"],"names":["reRenderImages","images","index","length","centerImg","center","concat","Object","toConsumableArray","slice","objectSpread","reverse","ranges","wrap","w","document","body","clientWidth","h","photo","range","left","x","y","right","splice","ImagesLeft","Math","floor","map","item","random","top","transform","ImagesRight","temp","undefined","max","min","diff","ceil","useImagesHook","_useState","useState","_useState2","slicedToArray","_useState2$","setImages","onHandleImageClick","useCallback","curImages","newImages","useEffect","Axios","get","then","result","data","idx","ImageSection","props","onHandleImageCick","react_default","a","createElement","className","classNames","photo_front","photo_back","photo_center","style","onClick","src","filePath","alt","title","desc","NavSection","items","classnames","i_current","i_back","Wrapper","styled","div","_templateObject","App","_useImagesHook","_useImagesHook2","_images","_onHandleImageCick","Fragment","key","ReactDOM","render","src_App","getElementById"],"mappings":"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","file":"static/js/main.a2687a69.chunk.js","sourcesContent":["import ImageInfo, { Range } from \"./types\";\r\n\r\n/**\r\n * 重新排布图片\r\n * @param images\r\n * @param index\r\n */\r\nexport default function reRenderImages(\r\n  images: ImageInfo[],\r\n  index: number\r\n): ImageInfo[] {\r\n  if (index < 0 || index > images.length) {\r\n    return images;\r\n  }\r\n\r\n  const centerImg = images[index];\r\n  if (centerImg.center) {\r\n    return [\r\n      ...images.slice(0, index),\r\n      { ...centerImg, reverse: !centerImg.reverse, center: true },\r\n      ...images.slice(index + 1)\r\n    ];\r\n  } else {\r\n    const ranges = range();\r\n    images.splice(index, 1);\r\n    const ImagesLeft = images\r\n      .splice(0, Math.floor(images.length / 2))\r\n      .map(item => ({\r\n        ...item,\r\n        reverse: false,\r\n        center: false,\r\n        left: random(ranges.left.x),\r\n        top: random(ranges.left.y),\r\n        transform: `rotate(${random([-45, 45])}deg) scale(1)`\r\n      }));\r\n    const ImagesRight = images.map(item => ({\r\n      ...item,\r\n      reverse: false,\r\n      center: false,\r\n      left: random(ranges.right.x),\r\n      top: random(ranges.right.y),\r\n      transform: `rotate(${random([-45, 45])}deg) scale(1)`\r\n    }));\r\n\r\n    const temp = [...ImagesLeft, ...ImagesRight];\r\n    return [\r\n      ...temp.slice(0, index),\r\n      {\r\n        ...centerImg,\r\n        center: true,\r\n        left: undefined,\r\n        top: undefined,\r\n        transform: undefined\r\n      },\r\n      ...temp.slice(index)\r\n    ];\r\n  }\r\n}\r\n\r\n/**\r\n *随机生成数值\r\n *\r\n * @param {number[]} range\r\n * @returns\r\n */\r\nfunction random(range: number[]) {\r\n  var max = Math.max(range[0], range[1]);\r\n  var min = Math.min(range[0], range[1]);\r\n  var diff = max - min;\r\n  return Math.ceil(Math.random() * diff + min);\r\n}\r\n\r\n/**\r\n *计算左右分区的范围\r\n *\r\n * @returns\r\n */\r\nfunction range() {\r\n  const wrap = {\r\n    w: document.body.clientWidth,\r\n    h: 600\r\n  };\r\n  const photo = {\r\n    w: 260,\r\n    h: 320\r\n  };\r\n\r\n  const range: Range = {\r\n    left: { x: [], y: [] },\r\n    right: { x: [], y: [] },\r\n    wrap: wrap,\r\n    photo: photo\r\n  };\r\n\r\n  range.left.x = [0, wrap.w / 2 - (photo.w * 3) / 2];\r\n  range.left.y = [0, wrap.h - photo.h / 2];\r\n  range.right.x = [wrap.w / 2 + photo.w / 2, wrap.w - photo.w / 2];\r\n  range.right.y = range.left.y;\r\n  return range;\r\n}\r\n","import { useState, useCallback, useEffect } from \"react\";\r\nimport reRenderImages from \"./utils\";\r\nimport ImageInfo from \"./types\";\r\nimport Axios from \"axios\";\r\n\r\nexport default function useImagesHook() {\r\n  const [images = [], setImages] = useState<Array<ImageInfo>>();\r\n\r\n  const onHandleImageClick = useCallback(\r\n    (index: number, curImages?: ImageInfo[]) => {\r\n      const newImages = reRenderImages(curImages || images, index);\r\n      setImages(newImages);\r\n    },\r\n    [images]\r\n  );\r\n\r\n  const fetchImages = () => {\r\n    return Axios.get<ImageInfo[]>(\"/images.json\").then((result: any) => {\r\n      const images = result.data.map((item: any) => ({\r\n        ...item,\r\n        center: false,\r\n        reverse: false\r\n      }));\r\n      return images;\r\n    });\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchImages().then(images => {\r\n      const idx = Math.floor(Math.random() * images.length);\r\n      onHandleImageClick(idx, images);\r\n    });\r\n  }, []);\r\n\r\n  return [images, onHandleImageClick];\r\n}\r\n","import React from \"react\";\r\nimport ImageInfo from \"./types\";\r\nimport \"./image.css\";\r\nimport classNames from \"classnames\";\r\n\r\ninterface Props {\r\n  item: ImageInfo;\r\n  onHandleImageCick: (idx: number) => void;\r\n  idx: number;\r\n}\r\nexport default function ImageSection(props: Props) {\r\n  const { item, onHandleImageCick, idx } = props;\r\n  return (\r\n    <div\r\n      className={classNames(\"photo\", {\r\n        photo_front: !item.reverse,\r\n        photo_back: item.reverse,\r\n        photo_center: item.center\r\n      })}\r\n      style={{\r\n        left: item.left,\r\n        top: item.top,\r\n        transform: item.transform\r\n      }}\r\n      onClick={() => onHandleImageCick(idx)}\r\n    >\r\n      <div className=\"photo_wrap\">\r\n        <div className=\"side side_front\">\r\n          <p className=\"image\">\r\n            <img src={`/images/${item.filePath}`} alt=\"\" />\r\n          </p>\r\n          <p className=\"caption\">{item.title}</p>\r\n        </div>\r\n        <div className=\"side side_back\">\r\n          <p className=\"desc\">{item.desc}</p>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n","import React from \"react\";\r\nimport ImageInfo from \"./types\";\r\nimport classnames from \"classnames\";\r\nimport \"./image.css\";\r\n\r\ninterface Props {\r\n  items: ImageInfo[];\r\n  onHandleImageCick: (idx: number) => void;\r\n}\r\nexport default function NavSection(props: Props) {\r\n  const { items, onHandleImageCick } = props;\r\n  return (\r\n    <div className=\"nav\">\r\n      {items.map((item, idx) => {\r\n        return (\r\n          <span\r\n            className={classnames(\"i\", {\r\n              i_current: item.center,\r\n              i_back: item.reverse\r\n            })}\r\n            onClick={() => onHandleImageCick(idx)}\r\n          />\r\n        );\r\n      })}\r\n    </div>\r\n  );\r\n}\r\n","import React from \"react\";\nimport styled from \"styled-components\";\nimport useImagesHook from \"./useImagesHook\";\nimport ImageSection from \"./ImageSection\";\nimport ImageInfo from \"./types\";\nimport NavSection from \"./NavSection\";\n\nconst Wrapper = styled.div`\n  width: 100%;\n  height: 600px;\n  position: absolute;\n  top: 50%;\n  margin-top: -300px;\n  background-color: #333;\n  overflow: hidden;\n  perspective: 800px;\n`;\n\nfunction App() {\n  const [images, onHandleImageCick] = useImagesHook();\n  // TODO: 不强转就是报错，莫名其妙，先这样，回头排查\n  const _images = images as ImageInfo[];\n  const _onHandleImageCick = onHandleImageCick as (idx: number) => void;\n  return (\n    <Wrapper>\n      {_images.map((item, idx) => {\n        return (\n          <React.Fragment>\n            <ImageSection\n              key={idx}\n              idx={idx}\n              item={item}\n              onHandleImageCick={_onHandleImageCick}\n            />\n            <NavSection\n              items={_images}\n              onHandleImageCick={_onHandleImageCick}\n            />\n          </React.Fragment>\n        );\n      })}\n    </Wrapper>\n  );\n}\n\nexport default App;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport App from \"./App\";\n\nReactDOM.render(<App />, document.getElementById(\"root\"));\n"],"sourceRoot":""}